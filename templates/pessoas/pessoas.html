{% extends "base.html" %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'pessoas/css/pessoas.css' %}">
{% endblock %}

{% block dashboard %}
<div class="pessoas-section container">

    <!-- Card -->
    <div class="row">
        <div class="col card-pessoa">
            <div class="nome-pessoa">Lista de pessoas cadastradas no sistema</div>
            <button class="btn-add-pessoa" onclick="document.getElementById('form-adicionar-cliente').classList.toggle('d-none')">
                Adicionar Pessoa
            </button>
        </div>
    </div>

    <!-- Formulário -->
    <div id="form-adicionar-cliente" class="adicionar-cliente mt-3 d-none">
        <form action="{% url 'adicionar_pessoa' %}" method="POST">
            {% csrf_token %}
            <div class="form-group">
                <label for="nome">Nome completo:</label>
                <input type="text" class="form-control" name="nome" placeholder="Nome completo">
            </div>
            <div class="form-group">
                <label for="email">E-mail:</label>
                <input type="email" class="form-control" name="email" placeholder="nome@email.com">
            </div>
            <div class="form-group">
                <label for="cpf">CPF:</label>
                <input type="text" class="form-control" name="cpf" placeholder="___.___.___-__">
            </div>
            <div class="form-group">
                <label for="senha">Senha:</label>
                <input type="password" class="form-control" name="senha" placeholder="Senha">
            </div>
            <div class="form-group">
                <label for="tipo_acesso">Tipo de Acesso:</label>
                <select name="tipo_acesso" class="form-control">
                    <option value="SECRETARIA">Secretaria</option>
                    <option value="FUNCIONARIO">Funcionário</option>
                    <option value="ADMINISTRADOR">Administrador</option>
                </select>
            </div>
            <input type="submit" class="btn-principal" value="Cadastrar">
        </form>
    </div>

    <!-- Tabela -->
    <table class="table-pessoas mt-4">
        <thead>
            <tr>
                <th>Nome</th>
                <th>E-mail</th>
                <th>CPF</th>
                <th>Tipo de Acesso</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for pessoa in pessoas %}
            <tr>
                <td>{{ pessoa.nome }}</td>
                <td>{{ pessoa.email }}</td>
                <td>{{ pessoa.cpf }}</td>
                <td>{{ pessoa.get_tipo_acesso_display }}</td>
                <td>
                    <a href="{% url 'editar_pessoa' pessoa.id %}" class="btn-principal">Editar</a>
                    <a href="{% url 'excluir_pessoa' pessoa.id %}" class="btn-add-pessoa">Excluir</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="5">Nenhuma pessoa cadastrada.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
