{% load static %}
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'general/css/base.css' %}">
  <link rel="stylesheet" href="{% static 'general/css/general.css' %}">
  <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>

  {% block head %}{% endblock %}
  <title>{% block title %}Correios FAAMA{% endblock %}</title>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo-details">
      <div class="logo_name">Correios FAAMA</div>
      <i class='bx bx-menu' id="btn"></i>
    </div>
    <ul class="nav-list">
      <li><a href="{% url 'home' %}"><i class='bx bx-home'></i><span class="links_name">InÃ­cio</span></a></li>
      <li><a href="{% url 'pessoas' %}"><i class='bx bx-user'></i><span class="links_name">Pessoas</span></a></li>
      <li><a href="{% url 'listar_encomendas' %}"><i class='bx bx-package'></i><span class="links_name">Encomendas</span></a></li>
      <li><a href="javascript:void(0)" onclick="logout()"><i class='bx bx-log-out'></i><span class="links_name">Sair</span></a></li>
    </ul>
  </div>

  <!-- ConteÃºdo -->
  <section class="home-section">
    {% block dashboard %}{% endblock %}
  </section>

  {% block body %}{% endblock %}

  <!-- JS -->
  <script src="{% static 'general/js/base.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    // ðŸš¨ Bloqueia acesso sem login
    if (!localStorage.getItem("access") && !window.location.pathname.startsWith("/login")) {
      window.location.href = "/login/";
    }

    // ðŸ”‘ Axios sempre manda o token
    axios.interceptors.request.use(config => {
      const token = localStorage.getItem("access");
      if (token) config.headers.Authorization = `Bearer ${token}`;
      return config;
    });

    // ðŸšª Logout
    function logout() {
      localStorage.clear();
      window.location.href = "/login/";
    }
  </script>
  <script>
  // ðŸš¨ Se nÃ£o tiver token, redireciona para login
  if (!localStorage.getItem("access")) {
    window.location.href = "/login/";
  }
</script>
</body>
</html>
